---
title: 权限控制发展综述
toc: true
date: 2019-12-04 11:46:34
author: GSM
tags:
categories: 业务实践
---
本文试图用不那么学术性的白话解释各种权限管理模型和适合使用场景。
<!--more-->
# 名词解释
- 主体：进行资源访问的实体。例如用户，服务，进程等。为了易于理解起见，本文将主体简化为用户。
- 客体：资源。例如系统，数据等，本文将客体简化为资源。
- 访问控制：访问控制限制主体对客体的访问权限，从而使系统在合法范围内使用；其实就是解决谁可以对什么资源进行什么样的操作的问题。

例如，某个页面只能由公司HR访问，这里主体是公司的HR，客体就是页面, 通过给公司HR关联权限达到限制页面访问的目的。
# ACL
ACL（Access Contrl List）是上个世纪90年代提出的权限控制模型。ACL是一个规则列表, 将客体和主体进行了映射, 规定了客体资源可以被哪些主体进行操作。例如公司的docker白名单（给docker添加了某个IP白名单，这台docker就可以访问这个IP）。另外公司弹性云集群流量隔离都是通过ACL去实现的访问控制。再比如某些业务系统使用ACL定义了用户和业务线的访问控制关系。
<img src="acl.png" alt="ACL模型" width = "400" height = "200" align=center />
ACL的优点在于它非常简单，易于实现。但是它的缺点也非常明显： 用户和资源直接关联，在应对大量用户和客体资源的权限管控的时候，访问控制列表就会变得非常繁琐。解决思路也非常简单，用户和资源之间再抽象一层，给资源分一个资源类，用户直接和这个类别关联，这样就清晰很多 -- 这个资源类就是角色。

# RBAC
RBAC （Role Based Access Control） 模型也是上个世纪90年代提出的ACL增强版的权限控制模型。RBAC将人和资源解耦，在用户和资源之间增加了一个中间桥梁 -- 角色。 角色可以看做是一组操作的集合，不同的角色具有不同的操作集，这些操作集关联到用户身上。一个用户可以拥有多个角色，从而实现权限管理的灵活性。
<img src="rbac.png" alt="RBAC模型" width = "600" height = "300" align=center />

例如「XX系统」根据用户的岗位分为了“运营角色”，“客服角色”，“电销管理员角色”，“财务角色”等多个角色。再例如「XX系统」根据自身业务内容划分了角色：“问题诊断角色”, "查询角色"等。

## ACL✖️RBAC 
公司拥有多条业务线，例如专车，快车, 安全等等。这样在管理权限时候就会遇到一个问题 -- 如何管理不同业务线的同一类操作问题。而这类问题使用RBAC和RBAC✖️ACL都可以解决:
- RBAC模型：「A系统」针对不同业务线的同一个操作设置了多个角色，例如角色“专车-看板角色”, “快车-看板角色”,”安全-看板角色”等等。
- RBAC✖️ACL的模型：「B系统」使用ACL标识定义了业务线资源（设置了标识位：专车，快车, 安全），再设置了一个“看板角色”，用户在申请角色的时候选择自己业务线的标识位，再选择看板角色即可。

可以看出虽然是同一个RBAC模型，不同使用者（业务系统）使用的效果各异。这就好比在权限系统提供基础食材（权限模型），各个厨师（业务系统）对各个基础食材各有发挥，做出来的菜也不一样。同样是土豆，有的厨师做出了土豆丝，有的做出了薯条。每一种使用方式都可以解决业务系统的业务问题，权限系统重点在于提供一个可以让厨师自由选择食材的平台。

RBAC模型的优点显而易见：大大简化了权限管理，降低了管理开销，使得权限管理系统具有更强大的可操作性和可管理性。事实证明，RBAC也是公司目前被业务系统使用最多的权限管理模型。

纵观ACL和RBAC两个模型，这两个模型虽然强大，但是仍然很难覆盖所有权限管理场景。例如管控“预算部门是汽车资产管理中心且操作城市是北京”的用户的某一角色权限，普通的RBAC或者多个ACL✖️RBAC模型管理的复杂度会增加很多。总结来说，复杂的权限管控场景需要可以动态根据一个或者一组属性是否满足某种条件进行权限判断，而这就是ABAC产生的背景。

# ABAC
Attribute Based Access Control (ABAC)是2013提出的模型。不同于RBAC和ACL将用户通过某种方式与资源关联的方式，ABAC是通过动态计算一个或者一组属性是否满足某种条件进行授权判断。ABAC可以实现非常灵活的权限控制，几乎能满足所有类型的需求。

ABAC的属性有四类：
- 用户属性（用户职位）
- 操作属性（增删改查）
- 环境属性 （当前时间）
- 资源属性

目前我们的ABAC模型是给资源添加各种策略（属性），模型如下图：
<img src="abac.png" alt="ABAC模型" width = "600" height = "300" align=center />

ABAC模型虽然强大，但是通常这个模型都是最后一个选择。实际使用中往往我们推荐给权限模型使用者都是RBAC>ACL>ABAC. 正是因为ABAC模型很强大，他试图解决所有权限管理场景，就会带来管理策略非常复杂的问题，使用起来也不是很用户友好，实际场景难以运营和落地。
 
# Summary
目前我们的系统作为统一权限管理平台，支持ACL,RBAC以及ABAC三种权限模型的管理。 












